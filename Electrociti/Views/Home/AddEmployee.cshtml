@{
    ViewData["Title"] = "AddEmployee";
}
@using Electrociti.ViewModels
@model Employee

<form asp-action="AddEmployee" asp-controller="Home" method="post" class="form-container">
    <div>
        <div>
            <h1>Добавление сотрудника</h1>
        </div>

        <div>
            <input type="file" id="eImgFile" accept="image/*" onchange="convertToBase64(this)">
            <input type="hidden" id="eImg" name="Image" />
        </div>

        <div>
            <input type="text" id="eName" name="EmployeeName" placeholder="Имя сотрудника" pattern="[A-Za-zА-Яа-яЁё]+" title="Только буквы" autocomplete="off" required />
        </div>

        <div>
            <input type="text" id="eSecName" name="SecondName" pattern="[A-Za-zА-Яа-яЁё]+" title="Только буквы" placeholder="Фамилия сотрудника" autocomplete="off" />
        </div>

        <div>
            <input type="text" id="ePatronomic" name="Patronomic" pattern="[A-Za-zА-Яа-яЁё]+" title="Только буквы" placeholder="Отчество сотрудника" autocomplete="off" />
        </div>

        <div>
            <textarea id="eDescription" name="EmployeeDescription" placeholder="Описание сотрудника" autocomplete="off" class="textAreaDescription" oninput="autoResize(this)"></textarea>
        </div>

        <div>
            <input type="text" id="eAddress" name="EmployeeAddress" placeholder="Адрес сотрудника" autocomplete="off" required />
        </div>

        <div>
            <input type="text" id="ePhone" name="EmployeePhone" placeholder="Телефон сотрудника" maxlength="11" autocomplete="off" required />
            <span asp-validation-for="EmployeePhone" class="text-danger"></span>
        </div>

        <div>
            <input type="text" id="eRate" name="EmployeeRate" placeholder="Рейтинг сотрудника" required min="1" pattern="[0-5]+" title="Введите только цифры" autocomplete="off"/>
        </div>

        <div>
            <input type="password" id="ePassword" name="EmployeePassword" placeholder="Пароль" autocomplete="off" required />
        </div>

        <div>
            <p>Дата рождения</p>
            <input type="date" id="eDate" name="SelectedDate" max="@ViewBag.Today" />
        </div>
        <button type="submit">Сохранить</button>
    </div>
</form>

<script>
    function convertToBase64(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                var base64String = e.target.result;
                // Проверка валидности строки Base64
                if (base64String.startsWith("data:image/") && base64String.includes("base64,")) {
                    document.getElementById('eImg').value = base64String;
                } else {
                    alert("Некорректное изображение.");
                }
            };
            reader.readAsDataURL(input.files[0]);
        }
    }

    function autoResize(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = (textarea.scrollHeight) + 'px';
    }

    // Инициализация высоты textarea при загрузке страницы
    document.addEventListener('DOMContentLoaded', function () {
        var textareas = document.querySelectorAll('textarea');
        textareas.forEach(function (textarea) {
            autoResize(textarea);
        });
    });
</script>
